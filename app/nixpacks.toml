# Nixpacks configuration for Railway - App
# Sadece Node.js gerekiyor, Python gerekmiyor

providers = []

[phases.setup]
# Node.js 20 kullanıyoruz (Expo ve React Native için uyumlu)
# KRİTİK: Railway'de NIXPACKS_NODE_VERSION=20 environment variable'ı ZORUNLU!
# Bu olmadan Node.js 22 kullanılır ve engine hatası alırsınız
nixPkgs = ["pkgs.nodejs_20"]

[phases.install]
# KRİTİK: Root'tan build yapılıyorsa, root'taki package-lock.json workspaces içeriyor
# Bu yüzden app dizinine geçip sadece app'in bağımlılıklarını kurmalıyız
# App dizininde npm install kullanarak kendi lock file'ını oluşturmasına izin veriyoruz
# Bu sayede root'taki workspaces ve server bağımlılıkları ignore edilir
cmds = [
  "cd app && npm install --omit=dev"
]

[phases.build]
cmds = []

[start]
# App dizininden başlat
cmd = "cd app && npm start"
