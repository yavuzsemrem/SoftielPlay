# Nixpacks configuration for Railway - App
# Sadece Node.js gerekiyor, Python gerekmiyor

providers = []

[phases.setup]
# Node.js 20 kullanıyoruz (Expo ve React Native için uyumlu)
# Railway'de NIXPACKS_NODE_VERSION=20 environment variable'ı da ayarlanmalı
nixPkgs = ["pkgs.nodejs_20"]

[phases.install]
# Sadece app dizinindeki bağımlılıkları kur
# ÖNEMLİ: Railway'de Root Directory = "app" olarak ayarlanmalı
# Eğer root directory ayarlanmamışsa, app dizinine geçip kurulum yap
# Bu sayede root'taki workspaces nedeniyle server bağımlılıkları kurulmaz
cmds = [
  "if [ -f app/package.json ]; then cd app && npm ci --omit=dev; else npm ci --omit=dev; fi"
]

[phases.build]
cmds = []

[start]
# Root directory app olarak ayarlandığında direkt npm start çalışır
# Eğer root directory ayarlanmamışsa, app dizinine geçip başlat
cmd = "if [ -f app/package.json ]; then cd app && npm start; else npm start; fi"
